<html>
  <head>
    <title>Temperature</title>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
  </head>
  <body>
    <h1>Temperatura: <span id="temperature"></span></h1>
    <div id="alert" style="display:none;">La temperatura es demasiado alta ðŸ”¥</div>
    <canvas id="myChart"></canvas>
    <script>
      var ctx = document.getElementById('myChart').getContext('2d');
      var myChart = new Chart(ctx, {
          type: 'line',
          data: {
              labels: [],
              datasets: [{
                  label: 'Temperatura',
                  data: [],
                  backgroundColor: 'rgba(255, 99, 132, 0.2)',
                  borderColor: 'rgba(255, 99, 132, 1)',
                  borderWidth: 1
              }]
          },
          options: {
              scales: {
                  yAxes: [{
                      ticks: {
                          beginAtZero: true
                      }
                  }]
              }
          }
      });

      function updateTemperature() {
        fetch('/temperature')
          .then(response => response.json())
          .then(data => {
            document.querySelector('#temperature').innerHTML = data.temperature;
            myChart.data.labels.push(new Date().toLocaleTimeString());
            myChart.data.datasets[0].data.push(parseFloat(data.temperature.replace(' Â°C', '')));
            myChart.update();
            if (parseFloat(data.temperature.replace(' Â°C', '')) > 28) {
              document.querySelector('#alert').style.display = 'block';
            } else {
              document.querySelector('#alert').style.display = 'none';
            }
          });
      }

      setInterval(updateTemperature, 5000); // 5 seconds

    </script>
  </body>
</html>